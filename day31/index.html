<meta name="monetization" content="$pay.stronghold.co/1a1fbf27169a5334158b2c531b946427ceb">
<div id=b>

<script src=css3d.js></script>
<script src=levels.js></script>
<script src=global.js></script>
<script src=music.js></script>
<script src=helpers.js></script>
<script src=func.js></script>
<script src=collision.js></script>
<script src=editor.js></script>
<script src=race.js></script>
<script src=blocks.js></script>
<script src=input.js></script>
<script src=init.js></script>
<script src=loop.js></script>

<script>
// ===============
//  BACK ON TRACK
// ===============

// Summary
// -------

// The game takes place on a 20x20x20 3D grid. (=> see space)
// Each cell of this grid:
// - measures 100x100x50px,
// - can contain 0 or 1 road cell,
// - has an equation that the game can check to ensure the car is on the road,
// - can be linked to 0 to 4 other road,
// - can have 0 to 4 barriers.

// Temp
// ----

//C.plane({n:"debug",b:"#00F",w:1,h:1,z:1});

</script>

</div>

<style>
*{margin:0;padding:0;box-sizing:border-box;font-family:calibri;cursor:pointer;user-select:none;-moz-user-select:none;}
#viewport{width:100vw;height:100vh;background:#fff;overflow:hidden;position:relative;perspective:700px}
#viewport *,.part *{transform-style:preserve-3d;box-sizing:border-box}
#camera{width:0;height:0;position:absolute;top:55%;left:50%}

.circle{border-radius:50%}
#deb{position:fixed;top:0;left:0;z-index:2;xtop:-999px;font-size:10px}
.plane{text-align:center;font-size:25px;line-height:20px}
.block0.z0{border:1px solid #ddd}
.barrierleftright.z0{border-left:6px solid #000;border-right:6px solid #000}
.barriertopbottom.z0{border-top:6px solid #000;border-bottom:6px solid #000}

/* Menu */
.m, .s { text-align: center; position: fixed; top: 50%; margin: -180px 0 0; width: 100%; }
.m div, .m a { padding: 5px 15px; font-size: 30px; border: 1px solid; display: inline-block; margin: 5px; background: #d90; }

/* Editor CSS */
#grid { background: linear-gradient(#888 2px, transparent 2px), linear-gradient(90deg, #888 2px, transparent 2px),#def8; background-size: 100px 100px; }
#menu { position: fixed; left: 0; top: 0; text-align:center; width: 145px; background: #fff; padding: 5px; border: 2px solid}
#menu div { width: 60px; display: inline-block; height: 30px; border: 2px solid #555; background:#eee; font-size: 20px; margin: 2px 0;}
#parts { position: fixed; bottom: 0; text-align:center; width: 100%; }
.part { width: 60px; height: 80px; border: 2px solid #555; background:#ddd; display: inline-block; vertical-align: top; perspective: 500px;}

.part.selected { background: #fff }
.visual { height: 30px; margin: 25px 30px 0; }
.fx .editor #scene{ transition:.2s linear }
p{text-align:left;background:#eee; margin: 0 2px; padding: 5px}
#cursor { transition:.1s linear }
.tree { font-size: 90px; line-height: 90px; text-align: center; }
.ice { border-radius: 25px; background: #def; background: linear-gradient(45deg, #def, #cde, #def, #cde, #def); background-size: 2000px 2000px; }

/* Parts CSS */
.acc { background: linear-gradient(70deg, transparent 75%, #fd3 75%) center center, linear-gradient(-70deg, #d90 75%, #fd3 75%) center center,#d90; background-size: 26px 24px; }
.acc2 { background: linear-gradient(110deg, transparent 75%, #fd3 75%) center center, linear-gradient(-110deg, #d90 75%, #fd3 75%) center center,#d90; background-size: 26px 24px; }
.w1 .acc { background: linear-gradient(70deg, transparent 75%, #fd3 75%) center center, linear-gradient(-70deg, #999 75%, #fd3 75%) center center,#999; background-size: 26px 24px; }
.w1 .acc2 { background: linear-gradient(110deg, transparent 75%, #fd3 75%) center center, linear-gradient(-110deg, #999 75%, #fd3 75%) center center,#999; background-size: 26px 24px; }

/*.hole { background: radial-gradient(transparent 45%,#d90 45%);}*/

/* race */
.race #viewport { background: linear-gradient(#def 10%,#fff 15%); }
.editor h1, .race h1 {position: fixed; right: 10px }
#time { right: auto; left: 10px; }
#speed { bottom : 0px; }

/* score */
.s { font-size: 50px; margin: -100px 0 0; }
.s div { width: 400px; height: 60px; font-size: 50px; border: 2px solid; margin: 50px auto; background: #d90; }

/* Desert */
.w1 #viewport { background: #ec7; }
.race.w1 #viewport { background: linear-gradient(#def 10%,#ec7 15%) }